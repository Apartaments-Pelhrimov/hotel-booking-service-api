openapi: "3.0.3"
info:
  title: "hotel-booking-service API"
  description: "API docs for hotel-booking-service"
  version: "1.0.0"
servers:
  - url: "http://localhost:8080"
paths:




#  ----------------------------------- AUTH -----------------------------------

  /api/auth/login:
    post:
      summary: "POST api/auth/login"
      operationId: "token"
      security:
        - basicAuth: []
      responses:
        "200":
          description: "OK"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/AuthResponseDto"
        "401":
          description: "Unauthorized"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SpringDefaultServerError"
  /api/auth/register:
    post:
      summary: "POST api/auth/register"
      operationId: "register"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegistrationDto"
        required: true
      responses:
        "200":
          description: "OK"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/AuthResponseDto"
        "500":
          description: "Server error TODO: handle this exception"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SpringDefaultServerError"




  #  ----------------------------------- APARTMENTS -----------------------------------

  /api/hotels/{hotelId}/apartments:
    get:
      summary: "GET api/hotels/{hotelId}/apartments"
      operationId: "getAllInHotel"
      parameters:
        - name: "hotelId"
          in: "path"
          required: true
          schema:
            type: "integer"
            format: "int64"
        - name: "query"
          in: query
          required: false
          schema:
            type: "string"
        - name: "from"
          in: query
          required: true
          schema:
            type: string
            example: "2023-12-31"
            format: "YYYY-MM-DD"
            description: "Date of start of desired reservation"
        - name: "to"
          in: query
          required: true
          schema:
            type: string
            example: "2023-12-31"
            format: "YYYY-MM-DD"
            description: "Date of start of desired reservation"
        - name: "adult"
          in: query
          required: true
          description: "Number of adults (>0)"
          schema:
            type: "integer"
            format: "int64"
        - name: "child"
          in: query
          required: true
          description: "Number of children (>0)"
          schema:
            type: "integer"
            format: "int64"
        - name: "stars"
          in: query
          required: false
          description: "Filter, default = 0"
          schema:
            type: "integer"
            format: "int64"
        - name: "maxPrice"
          in: query
          required: false
          description: "Filter, default = Integer.MAX_VALUE (2^31-1)"
          schema:
            type: "integer"
            format: "int64"
        - name: "rating"
          in: query
          required: false
          description: "Filter, default = 0.0"
          schema:
            type: "number"
            format: "float"
        - name: "meals"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "kitchen"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "bathroom"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "wifi"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "refrigerator"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "pool"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "restaurant"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "parking"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
      responses:
        "200":
          description: "OK"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ApartmentSearchDto"
  /api/hotels/apartments/{id}:
    get:
      summary: "GET api/hotels/apartments/{id}"
      operationId: "getOne"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "integer"
            format: "int64"
      responses:
        "200":
          description: "OK"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ApartmentDto"
  /api/hotels/apartments/{id}/free:
    get:
      summary: "GET api/hotels/apartments/{id}/free"
      operationId: "isFree"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "integer"
            format: "int64"
        - name: "from"
          in: query
          required: true
          schema:
            type: string
            example: "2023-12-31"
            format: "YYYY-MM-DD"
            description: "Date of start of desired reservation"
        - name: "to"
          in: query
          required: true
          schema:
            type: string
            example: "2023-12-31"
            format: "YYYY-MM-DD"
            description: "Date of start of desired reservation"
      responses:
        "200":
          description: "OK"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/FreeApartmentDto"




#  ----------------------------------- HOTELS -----------------------------------

  /api/hotels:
    get:
      summary: "GET api/hotels"
      operationId: "getAll"
      parameters:
        - name: "query"
          in: query
          required: false
          schema:
            type: "string"
        - name: "from"
          in: query
          required: true
          schema:
            type: string
            example: "2023-12-31"
            format: "YYYY-MM-DD"
            description: "Date of start of desired reservation"
        - name: "to"
          in: query
          required: true
          schema:
            type: string
            example: "2023-12-31"
            format: "YYYY-MM-DD"
            description: "Date of start of desired reservation"
        - name: "adult"
          in: query
          required: true
          description: "Number of adults (>0)"
          schema:
            type: "integer"
            format: "int64"
        - name: "child"
          in: query
          required: true
          description: "Number of children (>0)"
          schema:
            type: "integer"
            format: "int64"
        - name: "stars"
          in: query
          required: false
          description: "Filter, default = 0"
          schema:
            type: "integer"
            format: "int64"
        - name: "maxPrice"
          in: query
          required: false
          description: "Filter, default = Integer.MAX_VALUE (2^31-1)"
          schema:
            type: "integer"
            format: "int64"
        - name: "rating"
          in: query
          required: false
          description: "Filter, default = 0.0"
          schema:
            type: "number"
            format: "float"
        - name: "meals"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "kitchen"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "bathroom"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "wifi"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "refrigerator"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "pool"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "restaurant"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
        - name: "parking"
          in: query
          required: false
          description: "Filter, default = false"
          schema:
            type: "boolean"
      responses:
        "200":
          description: "OK"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/HotelSearchDto"
  /api/hotels/{id}:
    get:
      summary: "GET api/hotels/{id}"
      operationId: "getOne"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "integer"
            format: "int64"
      responses:
        "200":
          description: "OK"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/HotelDto"




#  ----------------------------------- COMMENTS -----------------------------------

  /api/hotels/{hotelId}/comments:
    get:
      summary: "GET api/hotels/{hotelId}/comments"
      operationId: "getCommentsForHotel"
      parameters:
        - name: "hotelId"
          in: "path"
          required: true
          schema:
            type: "integer"
            format: "int64"
      responses:
        "200":
          description: "OK"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/CommentDto"
  /api/hotels/apartments/{apartmentId}/comments:
    get:
      summary: "GET api/hotels/apartments/{apartmentId}/comments"
      operationId: "getCommentsForApartment"
      parameters:
        - name: "apartmentId"
          in: "path"
          required: true
          schema:
            type: "integer"
            format: "int64"
      responses:
        "200":
          description: "OK"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/CommentDto"



  #  ----------------------------------- RESERVATIONS -----------------------------------

  /users/me/reservations:
    get:
      summary: "GET users/me/reservations"
      operationId: "getMyReservations"
      responses:
        "200":
          description: "OK"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ReservationDto"




  #  ----------------------------------- USERS -----------------------------------

  /users/me:
    get:
      summary: "GET users/me"
      operationId: "getMe"
      responses:
        "200":
          description: "OK"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/UserDto"









components:
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    RegistrationDto:
      type: "object"
      properties:
        name:
          type: "string"
        phone:
          type: "string"
        email:
          type: "string"
        password:
          type: "string"
    AuthResponseDto:
      type: "object"
      properties:
        id:
          type: "number"
        name:
          type: "string"
        token:
          type: "string"
    SpringDefaultServerError:
      type: "object"
      properties:
        timestamp:
          type: "string"
        status:
          type: "number"
        error:
          type: "string"
        path:
          type: "string"
    Photo:
      type: "object"
      properties:
        photoLink:
          type: "string"
    ApartmentOptions:
      type: "object"
      properties:
        mealsIncluded:
          type: "boolean"
        kitchen:
          type: "boolean"
        bathroom:
          type: "boolean"
        wifi:
          type: "boolean"
        refrigerator:
          type: "boolean"
    Bed:
      type: "object"
      properties:
        size:
          type: "integer"
          format: "int32"
        bunk:
          type: "boolean"
    BigDecimal:
      type: "object"
      properties: { }
    ApartmentSearchDto:
      type: "object"
      properties:
        name:
          type: "string"
        photos:
          type: "array"
          items:
            $ref: "#/components/schemas/Photo"
        options:
          $ref: "#/components/schemas/ApartmentOptions"
        rating:
          type: "number"
          format: "float"
        beds:
          type: "array"
          items:
            $ref: "#/components/schemas/Bed"
        oneDayCost:
          $ref: "#/components/schemas/BigDecimal"
    HotelOptions:
      type: "object"
      properties:
        pool:
          type: "boolean"
        restaurant:
          type: "boolean"
        publicShower:
          type: "boolean"
        parking:
          type: "boolean"
    Location:
      type: "object"
      properties:
        city:
          type: "string"
        locationLink:
          type: "string"
    AdditionalInfo:
      type: "object"
      properties:
        description:
          type: "string"
        rules:
          type: "string"
        notice:
          type: "string"
    ApartmentHotelDto:
      type: "object"
      properties:
        name:
          type: "string"
        options:
          $ref: "#/components/schemas/HotelOptions"
        location:
          $ref: "#/components/schemas/Location"
        info:
          $ref: "#/components/schemas/AdditionalInfo"
        stars:
          type: "integer"
          format: "int32"
    ApartmentDto:
      type: "object"
      properties:
        name:
          type: "string"
        photos:
          type: "array"
          items:
            $ref: "#/components/schemas/Photo"
        options:
          $ref: "#/components/schemas/ApartmentOptions"
        hotel:
          $ref: "#/components/schemas/ApartmentHotelDto"
        rating:
          type: "number"
          format: "float"
        beds:
          type: "array"
          items:
            $ref: "#/components/schemas/Bed"
        oneDayCost:
          $ref: "#/components/schemas/BigDecimal"
    FreeApartmentDto:
      type: "object"
      properties:
        free:
          type: "boolean"

    HotelSearchDto:
      type: "object"
      properties:
        name:
          type: "string"
        photos:
          type: "array"
          items:
            $ref: "#/components/schemas/Photo"
        location:
          $ref: "#/components/schemas/Location"
        rating:
          type: "number"
          format: "float"
        minCost:
          $ref: "#/components/schemas/BigDecimal"
        money:
          type: "string"
    HotelDto:
      type: "object"
      properties:
        name:
          type: "string"
        photos:
          type: "array"
          items:
            $ref: "#/components/schemas/Photo"
        options:
          $ref: "#/components/schemas/HotelOptions"
        location:
          $ref: "#/components/schemas/Location"
        info:
          $ref: "#/components/schemas/AdditionalInfo"
        stars:
          type: "integer"
          format: "int32"
        rating:
          type: "number"
          format: "float"
    CommentDto:
      type: "object"
      properties:
        userName:
          type: "string"
        creationDateTime:
          type: "string"
          format: "date-time"
        rate:
          type: "number"
          format: "float"
        userPhotoLink:
          type: "string"
        body:
          type: "string"
    ReservationApartmentDto:
      type: "object"
      properties:
        name:
          type: "string"
        photos:
          type: "array"
          items:
            $ref: "#/components/schemas/Photo"
        hotelName:
          type: "string"
        location:
          $ref: "#/components/schemas/Location"
    ReservationDetails:
      type: "object"
      properties:
        reservedFrom:
          type: "string"
          format: "date"
        reservedTo:
          type: "string"
          format: "date"
        fullCost:
          $ref: "#/components/schemas/BigDecimal"
        adults:
          type: "integer"
          format: "int32"
        children:
          type: "integer"
          format: "int32"
    ReservationDto:
      type: "object"
      properties:
        apartment:
          $ref: "#/components/schemas/ReservationApartmentDto"
        details:
          $ref: "#/components/schemas/ReservationDetails"
        date:
          type: "string"
          format: "date"
    NotificationSettings:
      type: "object"
      properties:
        receiveOrderEmails:
          type: "boolean"
        receiveNewsEmails:
          type: "boolean"
    UserDto:
      type: "object"
      properties:
        name:
          type: "string"
        photo:
          type: "string"
        phone:
          type: "string"
        email:
          type: "string"
        notificationSettings:
          $ref: "#/components/schemas/NotificationSettings"
